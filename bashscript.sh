#!/bin/bash



# Check if a memory dump file is provided as an argument
if [ $# -eq 0 ]; then
    echo "Please provide a memory dump file as an argument."
    exit 1
fi

dump_file="$1"

# Run Volatility plugins and create output files
python3 vol.py -f "$dump_file" windows.pslist > pslist.txt
python3 vol.py -f "$dump_file" windows.dlllist > dlllist.txt
python3 vol.py -f "$dump_file" windows.handles > handles.txt
python3 vol.py -f "$dump_file" windows.ldrmodules > ldrmodules.txt
python3 vol.py -f "$dump_file"  windows.modules > modules.txt

python3 vol.py -f "$dump_file"  windows.callbacks > callback.txt

echo "Output files created: pslist.txt, dlllist.txt, ldrmodules.txt, modules.txt, svcscan.txt, callbacks.txt"
